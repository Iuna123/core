/* TYPOlight webCMS :: Copyright (C) 2005 Leo Feyer :: LGPL license */
var Typobox={preInit:function(){var a;tinyMCEPopup.requireLangPack();if(a=tinyMCEPopup.getParam("external_image_list_url")){document.write('<script language="javascript" type="text/javascript" src="'+tinyMCEPopup.editor.documentBaseURI.toAbsolute(a)+'"><\/script>')}},init:function(){var d=document.forms[0],a=tinyMCEPopup.editor,e=a.selection.getContent();this.fillFileList("image_list","tinyMCEImageList");
if(!e||e.indexOf("image::")==-1){return}selectByValue(d,"rel","");e=e.replace(/^.*\{\{image::/gi,"");e=e.replace(/\}\}.*$/i,"");e=e.replace(/\[&amp;\]|\[&\]|&amp;|&/gi,"?");var b=e.split("?");d.src.value=b[0];for(i=1;i<b.length;i++){sub=b[i].split("=");switch(sub[0]){case"width":d.width.value=sub[1];break;case"height":d.height.value=sub[1];break;case"alt":d.alt.value=sub[1];break;case"class":d.cssClass.value=sub[1];
break;case"rel":selectByValue(d,"rel",sub[1]);break}}},fillFileList:function(f,c){var e=tinyMCEPopup.dom,a=e.get(f),d,b;c=window[c];if(c&&c.length>0){a.options[a.options.length]=new Option("","");tinymce.each(c,function(g){a.options[a.options.length]=new Option(g[0],g[1])})}else{e.remove(e.getParent(f,"tr"))}},update:function(){var h=document.forms[0],b=h.elements,c=tinyMCEPopup.editor,d={},e;tinyMCEPopup.restoreSelection();
if(h.src.value==""){tinyMCEPopup.close();return}var a=h.src.value;var g="?";if(h.width.value){a+=g+"width="+h.width.value;g="&amp;"}if(h.height.value){a+=g+"height="+h.height.value;g="&amp;"}if(h.alt.value){a+=g+"alt="+h.alt.value;g="&amp;"}if(h.cssClass.value){a+=g+"class="+h.cssClass.value;g="&amp;"}if(h.rel.value){a+=g+"rel="+h.rel.value}a="{{image::"+a+"}}";e=c.selection.getNode();c.execCommand("mceInsertRawHTML",false,a);
c.undoManager.add();tinyMCEPopup.close()}};Typobox.preInit();tinyMCEPopup.onInit.add(Typobox.init,Typobox);